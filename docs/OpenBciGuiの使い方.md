# OpenBCI GUIの使い方

OpenBCI Cyton + Daisyで脳波を取得・解析する際に使用する OpenBCI GUI の基本的な操作手順をまとめました。GUI はリアルタイム計測と録画データの再生の両方に対応しており、以下のセクションを順番に確認することでスムーズに活用できます。

## 1. 全体の流れ

1. OpenBCI Board と電極の準備・装着
2. OpenBCI GUI を起動し、System Control Panel でボード設定を行う
3. 【ライブ計測】Cyton と接続してストリーミング開始
4. 【再生】録画済みデータを Playback で読み込む
5. ウィジェットを活用して脳波指標を観察・解析
6. 必要に応じてデータを保存または外部アプリへ転送

---

## 2. System Control Panel の説明

System Control Panel（中央下部のパネル）は GUI の起点となる設定画面です。主な項目は次のとおりです。

- **Board Type**: 使用するデバイスを選択します。Cyton + Daisy の場合は `CytonDaisy` を指定。
- **Serial/Network**: 接続方式を選びます。USBドングルで接続する場合は `Serial` を選択し、ポート番号を指定。
- **Baud Rate**: Cyton は 115200 が推奨値。変更する必要はほぼありません。
- **Daisy Module**: Daisy 拡張を装着している場合は必ず有効化します（チャネル数が 16ch になります）。
- **Start Data Stream / Stop Data Stream**: データ取得の開始・停止ボタン。
- **Impedance Check**: 電極の接触抵抗を測定。計測前に確認するとノイズ低減に役立ちます。

設定が完了したら「Start Data Stream」を押して実際のデータストリームを開始します。

---

## 3. Cyton との接続方法

1. **ハードウェア準備**
   - Cyton ボードと Daisy 拡張を接続し、バッテリー・電極を装着。
   - USB ドングルを PC に挿入し、LED が点灯していることを確認。
2. **GUI の起動**
   - OpenBCI GUI を起動し、System Control Panel を開く。
3. **接続設定**
   - Board Type: `CytonDaisy`
   - Serial/Network: `Serial`
   - Serial Port: ドングルが割り当てられたポート（macOS なら `/dev/tty.usbserial-DATE` など）を選択。
   - Daisy Module: `On`
4. **接続テスト**
   - 「Start Data Stream」を押してストリーミングを開始。
   - GUI 上部のチャネル波形に変化が現れれば接続成功。
5. **トラブルシューティング**
   - 波形が表示されない場合はポート設定、電源、電極接触を確認。
   - エラーが出る場合はドングルの再接続、GUI の再起動を試す。

---

## 4. Playback（録画データ再生）の説明

録画済みデータを分析する場合は Playback モードを使用します。

1. System Control Panel で Board Type に `Playback` を選択。
2. 「File Path」に録画済みの `.txt` または `.csv` ファイルを指定。
3. 「Start Data Stream」を押すとファイルの先頭から再生が始まり、リアルタイムと同じようにウィジェットへ出力されます。
4. 再生速度を調整したい場合は Playback コントロールの Speed 設定を変更。
5. 再生を停止する場合は「Stop Data Stream」を押すか、再生バーの停止ボタンを使用。

Playback モードはオフライン解析やアルゴリズム検証に便利です。実際のハードウェア接続がなくても GUI で可視化・解析ができます。

---

## 5. 脳波分析で活用する主要ウィジェット

OpenBCI GUI には様々なウィジェットが用意されていますが、初めに押さえておきたいものを以下にまとめます。

### 5.1 Time Series

- 各チャンネルのリアルタイム波形を表示。
- ノイズやアーチファクトの確認、測定環境のチェックに最適。

### 5.2 FFT (Power Spectrum)

- 周波数分析を行い、アルファ波 (8–13 Hz) を含む帯域ごとのパワーを確認。
- バンドごとのピークや変動を見ることでリラックス状態などを定量化。

### 5.3 Band Power Widget

- 指定したバンド（例: Delta, Theta, Alpha, Beta, Gamma）のパワーをバー表示。
- アルファ波の変化を手早く追跡するのに便利。

### 5.4 Focus / Meditation (SDK Widgets)

- OpenBCI SDK を利用したメンタルステート指標を表示。
- アルファ波中心のリラックス度を定性的に確認。

### 5.5 Accelerometer / Motion

- 頭部の動きを計測。動きに伴うノイズを検出するのに役立ちます。

ウィジェットは右側の Widget Drawer から追加できます。目的に応じて組み合わせ、計測や録画の状況に合わせてレイアウトを調整してください。

---

## 6. アルファ波を取得するベストプラクティス

アルファ波はリラックス状態で顕著に表れる 8〜13 Hz の周波数帯です。安定した波形を得るためのポイントを整理しました。

1. **電極配置**
   - 後頭部（O1、O2）や頭頂部（Pz）など視覚皮質付近に電極を配置するとアルファ波が捉えやすい。
   - 参照電極は耳朶（A1/A2）や乳様突起を利用し、グラウンドは Cz 付近が一般的。

2. **環境整備**
   - 静かで落ち着いた部屋を選び、照明は少し落として視覚刺激を減らす。
   - 電源タップや Wi-Fi ルーターなどノイズ源から距離を取り、可能であればノートPCはバッテリー駆動にする。

3. **参加者の状態**
   - 計測前に深呼吸や軽いストレッチでリラックスを促す。
   - 「目を開ける／閉じる」を繰り返し、目閉時にアルファ波が増えるか確認する。

4. **インピーダンス管理**
   - GUI の Impedance Check で 20 kΩ 以下を目指す。
   - 乾式電極は位置調整を、湿式やペーストは適切な量で接触を安定化。

5. **データ処理の工夫**
   - 50/60 Hz のノッチフィルタをオンにして商用電源ノイズを低減。
   - Band Power や FFT で 8〜13 Hz のピークを定期的にチェックし、同条件で複数回計測して再現性を確保。
   - 計測時の姿勢や体調、時間帯をログに残し、解析時にコンテキストと合わせて評価する。

---

## 7. FFT Plot・Band Power・HeadPlot を使ったアルファ波の確認

GUI の代表的な可視化ウィジェットを活用してアルファ波の存在と強度をチェックする手順と目安値をまとめます。以下はいずれも O1/O2・Pz など後頭部付近のチャンネルを想定しています。

### 7.1 FFT Plot（Power Spectrum）

- **確認方法**
   1. FFT ウィジェットを開き、対象チャンネルを選択。
   2. 周波数レンジを 0〜40 Hz 程度に設定し、8〜13 Hz のピークを探す。
   3. 目を閉じた状態と開いた状態を比較すると、閉眼時にピークが顕著に増加するのが理想。
- **目安となるパワー値**
   - アルファ帯域の絶対パワーが 5〜15 µV²/Hz 程度に達すれば典型的なリラックス状態と判断しやすい。
   - 相対パワー（全体の総パワーに対する 8〜13 Hz の割合）が 30% を超えるとアルファ優勢な状態と見なされるケースが多い。
   - 開眼時は絶対パワーが 1〜3 µV²/Hz、相対パワーが 10〜15% 程度まで低下するのが一般的。閉眼との差を指標にする。

### 7.2 Band Power Widget

- **確認方法**
   1. Band Power を追加し、Alpha バンド（8〜13 Hz）を有効化。
   2. 「Compute Relative」オプションをオンにすると、各バンドの比率が一目で把握できる。
   3. 解析対象チャンネルを O1 / O2 などに切り替え、数値の安定性を確認。
- **目安となるパワー値**
   - 絶対パワーで 10 µV² 以上、相対パワーで 0.3〜0.4（30〜40%）程度を確保できれば十分なアルファ活性と判断できる。
   - 連続して 5 秒以上、値が維持されているかを確認することで、瞬間的なノイズとの切り分けが可能。
   - 開眼時は相対パワーが 0.1〜0.15（10〜15%）程度に落ち込むのが目安。閉眼との比率を比較し、差分が 2 倍以上ならアルファ反応が明瞭。

### 7.3 HeadPlot（Topographic Map）

- **確認方法**
   1. HeadPlot を起動し、「Alpha」もしくは 8〜13 Hz を中心にしたバンドを選択。
   2. `Normalization` を Relative に設定すると、部位ごとの増減が直感的にわかる。
   3. 計測中は後頭部（O1/O2 周辺）が暖色（高パワー）に変化するか観察。
- **目安となるパワー値**
   - ヒートマップのスケールを 0〜20 µV² 程度に設定し、後頭部が 8 µV² 以上の高輝度で表示されていれば良好。
   - 左右差が大きい場合は電極接触や姿勢を見直し、対称性が得られるよう調整すると解析精度が高まる。

> **注意**: ここで示した数値は一般的な成人被験者の目安です。個人差が大きいため、事前にベースライン計測を行い、被験者ごとの基準値を作成して比較することを推奨します。

---

## 参考Tips

- 計測前に必ず Impedance Check を行い、電極接触を最適化する。
- ノイズを抑えるため、PC やケーブルを含めアースを適切に確保。
- GUI で得られたデータは CSV 形式で保存し、Node.js + PostgreSQL バックエンドへ取り込んで長期解析に活用可能。
- Playback ファイルにラベルを付けて保管すると、後から特定のタスクや状態を再解析しやすい。

以上を踏まえて、OpenBCI GUI を活用したアルファ波解析に取り組んでみてください。